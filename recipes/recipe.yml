# yaml-language-server: $schema=https://schema.blue-build.org/recipe-v1.json
name: goose
description: given's own operating system experiment

base-image: ghcr.io/ublue-os/base-main
image-version: 42

modules:
  - type: akmods
    base: main
    install:
      - framework-laptop

  # Regenerate initramfs; must follow akmods
  - type: initramfs
    no-cache: true

  - type: script
    snippets:
      - dnf5 -y update
      - dnf5 -y upgrade

  - type: files
    files:
      - source: system
        destination: /

  - from-file: ../modules/00-system.yml
  - from-file: ../modules/01-atomic.yml
  - from-file: ../modules/02-desktop.yml
  - from-file: ../modules/03-cli.yml

  - type: script
    snippets:
      - dnf5 -y autoremove
      - dnf5 -y clean all

  - type: signing
    no-cache: true
