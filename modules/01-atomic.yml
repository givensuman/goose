# yaml-language-server: $schema=https://schema.blue-build.org/module-stage-list-v1.json
# This modules installs various bits of software useful for containerized
# systems like SilverBlue.
modules:
  # - type: script
  #   scripts:
  #     - docker.sh # Handle steps commented out below
  #                 # due to bug in BlueBuild `repos` key
  #
  - type: dnf
    install:
      packages:
        - containerd.io
        - distrobox
        - docker-buildx-plugin
        - docker-ce
        - docker-ce-cli
        - docker-compose-plugin
        - podlet
        - podman-compose
        - podman-remote
        - qemu-kvm
        - libvirt
        - virt-manager
        - virt-viewer
        - virt-install
    remove:
      packages:
        - toolbox # Prefer distrobox

  - type: systemd
    system:
      enabled:
        # Services installed above
        - containerd.service
        - podman.service
        - docker.service
        # Services in /usr/lib/systemd/system
        - podman-init.service
        - docker-rootless-setup.service
        - libvirtd-setup.service
